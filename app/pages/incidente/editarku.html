



<div class="row"></div>



 <div class="row">
<div class ="col-md-8">
<div class="jarviswidget" id="wid-id-6" data-widget-editbutton="false" data-widget-custombutton="false">
	

				<!-- widget div-->
				<div>
					
				
					<!-- end widget edit box -->
					
					<!-- widget content -->
					<div class="widget-body no-padding">
						
						<form  method="post" id="form" name ="form" class="smart-form">
							<header>
								<h2 class="row-seperator-header"><i class="fa fa-edit"></i> Revision  del Inicidente  Número: <b>{{incidente.idIncidente}}</b> </h2>
							</header>
<div class="alert alert-block alert-danger" ng-show="!paginaValida">
          <a class="close" data-dismiss="alert" href="#">×</a>
          <h4 class="alert-heading"><i class="fa fa-check-square-o"></i>Errores!</h4>
          <p>
            Se han encontrado errores o falta de información, por favor verifique
          </p>
        </div>
							<fieldset>
								<div class="row">
									<section class="col col-4">
										<label class="label"><strong>Fecha Creacion</strong></label>
										<label class="input">
										<span>{{incidente.fechaCreacion | date:'MM/dd/yyyy h:mma'}}</span>
										</label>
									</section>
									<section class="col col-4">
										<label class="label">SLA</label>
										<label class="input"> 
											<input type="number" ng-model="incidente.sla" name="sla" disabled>
										</label>
									</section>
									<section class="col col-4">
										<label class="label">Tiempo transcurrido</label>
										<label class="input">
											<input type="text" ng-model="incidente.tiempoTranscurrido" name="tiempo" disabled>
										</label>
									</section>
								</div>
<div class="row">
   
    <section class="col col-8">
										<label class="label">Titulo</label>
										<label class="input">
											<input type="text" name="nombre" ng-model="incidente.nombre" disabled>
										</label>
									</section>
    
    
    <section class="col col-4">
										<label class="label">Consultor</label>
										<label class="input">
											<input type="text" name="nombre" ng-model="incidente.consultor.nombre" disabled>
										</label>
									</section>
</div>
<div class="row">
   
    <section class="col col-6">
										<label class="label">Sistema</label>
											<label class="input">
											<input type="text" name="nombre" ng-model="incidente.tipoIncidente.Nombre" disabled>
										</label>
								
    </section>
 
  <section class="col col-6">
										<label class="label">Modulo</label>
											<label class="input">
											<input type="text" name="nombre" ng-model="incidente.subtipoincidente.Nombre" disabled>
										</label>
										
									
	</section>
    
    
</div>
								<section>
									<label class="label">Descripcion</label>
									<label class="textarea"> <i class="icon-append fa fa-comment" disabled></i> 										<textarea ng-model="incidente.descripcion" disabled rows="4" name="comment"></textarea> </label>
								
								</section>
								
								
<div class="row">
   
    <section class="col col-6">
										<label class="label">Origen Problema</label>
											<label class="input">
											<input type="text" name="nombre" ng-model="incidente.origenproblema.Nombre" disabled>
										</label>
										
								
    </section>
 
  <section class="col col-6">
										<label class="label">Codigo de Termino</label>
									<label class="input">
											<input type="text" name="nombre" ng-model="incidente.codigotermino.Nombre" disabled>
										</label>
	</section>
    
    
</div>						


<div class="row">
   
    <section class="col col-4">
										<label class="label">Estado</label>
									<label class="select">
										 <select class="input-sm" ng-model="incidente.idEstado" name="estado"
                                          ng-options="item.estado.EstadoId as item.estado.Nombre for item in  listas.estados" required>
                                              <option value="">-- Seleccione Estado--</option>
                                           </select>
                              
                              </label>
<p ng-show="!paginaValida  && form.estado.$error.required" class="help-block">Debe Seleccionar el "Estado"</p>
 </section>    
   <section class="col col-4" ng-show="incidente.idEstado==80">
   	<label class="label">Consultor</label>
									<label class="select">
										 <select class="input-sm" ng-model="incidente.idConsultor" name="consultor"
                                          ng-options="item.usuarioId as item.nombre for item in  listas.consultor">
                                              <option value="">-- Seleccione Consultor--</option>
                                           </select>
                              
                              </label>
   	
   	 
   	  </section> 
</div> 

  <section>
									<label class="label">Comentarios Key User</label>
									<label class="textarea"> <i class="icon-append fa fa-comment"></i> 										<textarea rows="4"  ng-model="incidente.comentarioConsultor" name="comentario"></textarea> </label>
								
								</section>

<section>
    	<label class="label">Estado</label>
										<label class="input">
    <input type="file" title="Choose File" name="archivo" ng-file-select="onFileSelect($files)"    data-ui-file-upload class="btn btn-primary">
    </label>
        </label>
        
        
   <div class="table-responsive">
               <table class="table table-striped table-bordered">
                   <thead>
                   <tr>
                       <th>Nombre Adjunto</th>
                       <th>Fecha</th>
                       <th>Opciones</th>

                   </tr>
                   </thead>
                   <tbody>
                   <tr ng-repeat="archivo in adjunto">
                       <td><a href="api/adjunto/obtenerarchivo/{{archivo.AdjuntoId}}">{{archivo.Nombre}}</a></td>
                       <td>{{archivo.FechaCreacion}}</td>
                       <td><span  class="glyphicon glyphicon-trash" ng-click="EliminarArchivo(archivo.AdjuntoId)"></span></td>
                   </tr>

                   </tbody>
               </table>
           </div>

</section>
								    
    
							</fieldset>

							<footer>
								<button type="button" name="Enviar" ng-click="guardar()" class="btn btn-success">
									Guardar
								</button>
							
							</footer>

						
						</form>
						
					</div>
					<!-- end widget content -->
					
				</div>
				<!-- end widget div -->
				
			</div>
			<!-- end widget -->
</div>

<div class ="col-md-4">
<div class="well well-sm well-light">
			<h3>Log de Eventos
			<br>
			<small>Acciones asociadas al sistema</small></h3>
		
		<div class="panel-group smart-accordion-default" id="accordion">
							<div class="panel panel-default"  ng-repeat="hist in incidente.historial">
								<div class="panel-heading">
									<h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#{{hist.idIncidenteHistorial}}"> <i class="fa fa-lg fa-angle-down pull-right"></i> <i class="fa fa-lg fa-angle-up pull-right"></i>{{hist.fechaCreacion | date:'MM/dd/yyyy h:mma'}} Estatus: {{hist.estado.Nombre}}</a></h4>
								</div>
								<div id={{hist.idIncidenteHistorial}} class="panel-collapse collapse in">
									<div class="panel-body no-padding">
										 <table class="table table-bordered">
					     <tr>
					         <td><b>Usuario</b></td>
					     </tr>
					     <tr>
					         <td><samp>{{hist.usuario.nombre}} </samp></td>
					     </tr>
                         <tr>
					         <td>Codigo Termino</td>
					     </tr>
					     <tr>
					         <td><samp>{{hist.codigotermino.Nombre}}</samp></td>
					     </tr>
                          <tr>
					         <td>Comentarios</td>
					     </tr>
					     <tr>
					         <td><samp>{{hist.comentarios}}</samp></td>
					     </tr>

					 </table>
									</div>
								</div>
							</div>
						
		</div>
		</div>
</div>

</div>











<!--  --------------------------- ->


<div class="row ng-scope">
  <div class="col-xs-12 col-sm-9 col-md-9 col-lg-9">
    <h1 class="page-title txt-color-blueDark">

      <!-- PAGE HEADER -->
      <i class="fa-fw fa fa-pencil-square-o"></i>
      Incidente
			<span>&gt;
			Editar Incidente
			</span>
    </h1>
  </div>
</div>
<div class="row">

  <div class="col-md-12">
 <section class="panel panel-default">
  <div class="panel-heading"><strong><span class="glyphicon glyphicon-asterisk"></span> Edición Incidente</strong></div>
  <div class="panel-body">

   <form enctype="multipart/form-data" name="formEditarIncidente" id="formEditarIncidente" class="form-horizontal ng-pristine ng-valid">
    <div class="form-group">
     <label for="" class="col-sm-2">Nº Incidente</label>
     <div class="col-sm-10">
      <p class="form-control-static">{{incidente.incidente.IncidenteId}}</p>
     </div>
    </div>
       <div class="form-group">
           <label for="" class="col-sm-2">Fecha Creación</label>
           <div class="col-sm-10">
               <p class="form-control-static">{{incidente.incidente.FechaCreacion | date:'MM/dd/yyyy h:mma' }}</p>
           </div>
       </div>


       <div class="form-group">
           <label for="" class="col-sm-2">Estado (Interno)</label>
           <div class="col-sm-10">
               <p class="form-control-static">  {{incidente.incidente.Estado}}</p>
           </div>
       </div>




    <div class="form-group">
     <label for="" class="col-sm-2">Título</label>
     <div class="col-sm-10 col-md-4">
      <p class="form-control-static">{{incidente.incidente.Asunto}}</p>
     </div>
    </div>
    <div class="form-group">
     <label for="" class="col-sm-2">Descripción</label>
     <div class="col-sm-10 col-md-4">
       <p class="form-control-static">{{incidente.incidente.TextoOriginal}}</p>
     </div>
    </div>


       <div class="form-group">
           <label for="" class="col-sm-2">Tipo problema</label>

           <div class="col-sm-10">
										<span class="ui-select">


                      <div ng-repeat="item in incidente.tipo | filter: { TipoIncidenteId:  incidente.incidente.TipoIncidenteId }">{{item.Nombre}}</div>

</span>
           </div>
       </div>

       <div class="form-group">
           <label for="" class="col-sm-2">Módulo</label>

           <div class="col-sm-10">
										<span class="ui-select">


<div ng-repeat="item in incidente.subtipo  | filter: { SubTipoIncidenteId:   incidente.incidente.SubTipoIncidenteId }:true">{{item.Nombre}}</div>


									 							</span>
       </div>

</div>
       <div class="form-group">
           <label for="" class="col-sm-2">Origen del Problema</label>

           <div class="col-sm-10">

												<span class="ui-select">

<div ng-repeat="item in incidente.origen  | filter: { OrigenProblemaId:   incidente.incidente.OrigenProblemaId }:true">{{item.Nombre}}</div>





										</span>									</div>
       </div>

       <div class="form-group">
           <label for="" class="col-sm-2">Código termino</label>

           <div class="col-sm-10">
										<span class="ui-select">


                      <div ng-repeat="item in incidente.codigo  | filter: { CodigoTerminoId:   incidente.incidente.CodigoTerminoId }:true">{{item.Nombre}}</div>



										</span>									</div>
       </div>




    <div class="form-group">
     <label for="" class="col-sm-2">Consultor asignado</label>

     <div class="col-sm-10"><p class="form-control-static">{{incidente.incidente.UsuarioIdConsultor}}</p>
																		</div>
    </div>



     <div class="form-group">
       <label for="" class="col-sm-2">Respuesta</label>
       <div class="col-sm-10 col-md-4">
         <textarea rows="3" class="form-control" ng-model="incidente.incidente.RespuestaKU" name="respuestaKU"  placeholder="Respuesta del KeyUser"></textarea>
       </div>
     </div>


     <div class="form-group">
       <label for="" class="col-sm-2">¿Se encuentra solucionado?</label>
       <div class="col-sm-4">
         <table width="190" border="0" cellspacing="0" cellpadding="0">
           <tbody><tr>
             <td><input type="radio" ng-model="incidente.incidente.EstadoSolucion" id="radio" value="1"  ></td>
             <td><strong>SI</strong></td>
             <td><input type="radio" ng-model="incidente.incidente.EstadoSolucion" id="radio2" value="0"></td>
             <td><strong>NO</strong></td>
           </tr>
           </tbody></table>
       </div>
     </div>




     <div class="form-group"  >
           <div class="col-sm-10 col-sm-offset-2">
               <button type="button" class="btn btn-w-md btn-gap-v btn-default">Volver</button>

               <button type="button" ng-disabled="incidente.incidente.EstadoSolucion != 1" class="btn btn-w-md btn-gap-v btn-success" ng-click="GrabarIncidente(99)">Cerrar Incidente</button>

              <button type="button" ng-disabled="incidente.incidente.EstadoSolucion != 0" class="btn btn-w-md btn-gap-v btn-danger" ng-click="GrabarIncidente(55)">Enviar a Consultor</button>
           </div>
       </div>


       <div class="col-md-12">
           <h3>Tabla de eventos</h3>
           <table ng-repeat="hist in incidente.historial" class="table table-bordered">
               <tbody>
               <tr>
                   <th width="20%">Número</th>
                   <td>{{hist.IncidenteHistorialId}}</td>
               </tr>
               <tr>
                   <th>Fecha</th>
                   <td>{{hist.FechaEvento | date:'MM/dd/yyyy h:mma'}}</td>
               </tr>
               <tr>
                   <th>Estado</th>
                   <td><span ng-repeat="item in incidente.estado | filter:{EstadoId:hist.Estado}">({{item.EstadoId}}) {{item.Nombre}}</span></td>
               </tr>
               <tr>
                   <th>Texto</th>
                   <td>{{hist.Observacion}}</td>
               </tr>
               <tr>
                   <th>Usuario</th>
                   <td>{{hist.usuarionombre}} </td>
               </tr>



               <tr>
                   <th>Código Término</th>
                   <td><span ng-repeat="item in incidente.codigo | filter:{CodigoTerminoId:hist.CodigoTerminoId}:true">{{item.Nombre}}</span> </td>
               </tr>

               <tr>
                   <th>Adjuntos</th>
                   <td><ul><li ng-repeat="archivo in incidente.adjunto | filter: { HistorialId: hist.IncidenteHistorialId } "><a href="api/adjunto/obtenerarchivo/{{archivo.AdjuntoId}}">{{archivo.Nombre}}</a></li></ul></td>
               </tr>
               </tbody>
           </table>


       </div>





   </form>


  </div>
 </section>
    </div>
  </div>
